"0",""
"0","# Представим, что мы проводим эксперимент и сравниваем ИМТ в двух группах пациентов"
"0","# n - количество наблюдений в каждой группе"
"0","# m1, sd1 - среднее арифметическое значение и среднеквадратическое отклонения "
"0","#           показателя в генеральной совокупности в группе 1"
"0","# m2, sd2 - среднее арифметическое значение и среднеквадратическое отклонения "
"0","#           показателя в генеральной совокупности в группе 2"
"0",""
"0","experiment <- function(n, m1, sd1, m2, sd2){"
"0","    "
"0","    # Генерируем таблицу с результатами измерений"
"0","    "
"0","    temp_data <- tibble("
"0","        # Группа"
"0","        group = rep(c(1, 2), each = n) %>% factor(),"
"0","        "
"0","        # Генерируем 2 случайные выборки анализируемого показателя"
"0","        x = c(rnorm(n, m1, sd1),"
"0","              rnorm(n, m2, sd2)) %>% round(1)"
"0","    )"
"0","    "
"0","    # Проводим сравнение количественной переменной"
"0","    t_test_p <- temp_data %>% "
"0","        t_test(x ~ group, var.equal = T) %>% "
"0","        pull(p)"
"0","    "
"0","    # Проводим сравнение порядковой переменной"
"0","    u_test_p <- temp_data %>% "
"0","        mutate(x_ord = case_when(x < 18 ~ 0,"
"0","                                 x < 25 ~ 1,"
"0","                                 x < 30 ~ 2,"
"0","                                 x < 35 ~ 3,"
"0","                                 x < 40 ~ 4,"
"0","                                 x >= 40 ~ 5)) %>% "
"0","        wilcox_test(x_ord ~ group) %>% "
"0","        pull(p)"
"0","    "
"0",""
"0","    # Проводим сравнение биномиальной переменной"
"0","    chi_test_p <- temp_data %>% "
"0","        mutate(x = case_when(x < 30 ~ 0,"
"0","                             x >= 30 ~ 1)) %>%"
"0","        table() %>% "
"0","        chisq.test() %>% "
"0","        .$p.value"
"0","    "
"0","    "
"0","    tibble("
"0","        t_test_p,"
"0","        u_test_p,"
"0","        chi_test_p"
"0","    )"
"0","    "
"0","}"
"0",""
